<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>harvester_e2e_tests.fixtures.terraform API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>harvester_e2e_tests.fixtures.terraform</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import re
import json
from pathlib import Path
from datetime import datetime
from subprocess import run, PIPE
from dataclasses import dataclass, field

import pytest
from pkg_resources import parse_version

TF_PROVIDER = &#39;&#39;&#39;
terraform {
  required_version = &#34;%(tf_version)s&#34;
  required_providers {
    harvester = {
      source  = &#34;%(provider_source)s&#34;
      version = &#34;%(provider_version)s&#34;
    }
  }
}

provider &#34;harvester&#34; {
    kubeconfig = &#34;%(config_path)s&#34;
}
&#39;&#39;&#39;

TF_PROVIDER_RANCHER = &#39;&#39;&#39;
terraform {
  required_providers {
    rancher2 = {
      source  = &#34;%(provider_source)s&#34;
      version = &#34;%(provider_version)s&#34;
    }
  }
}

provider &#34;rancher2&#34; {
  api_url   = &#34;%(rancher_endpoint)s&#34;
  token_key = &#34;%(rancher_token)s&#34;
  insecure = true
}

data &#34;rancher2_cluster_v2&#34; &#34;%(harvester_name)s&#34; {
  name = &#34;%(harvester_name)s&#34;
}

&#39;&#39;&#39;

# rancher2_machine_config_v2
TF_MACHINE_CONFIG = &#39;&#39;&#39;
resource &#34;rancher2_machine_config_v2&#34; &#34;%(name)s&#34; {
  generate_name = &#34;%(name)s&#34;
  %(harvester_config)s
}

&#39;&#39;&#39;
TF_HARVESTER_CONFIG = &#39;&#39;&#39;
  harvester_config {
    vm_namespace = &#34;default&#34;
    cpu_count = &#34;2&#34;
    memory_size = &#34;4&#34;
    ssh_user = &#34;%(ssh_user)s&#34;
    disk_info = %(disk_info)s
    network_info = %(network_info)s
    user_data = %(user_data)s
  }
&#39;&#39;&#39;
TF_DISK_INFO = &#39;&#39;&#39;&lt;&lt;EOF
    {
      &#34;disks&#34;: [{
        &#34;imageName&#34;: &#34;%(image_name)s&#34;,
        &#34;size&#34;: 40,
        &#34;bootOrder&#34;: 1
      }]
    }
    EOF
&#39;&#39;&#39;
TF_NETWORK_INFO = &#39;&#39;&#39;&lt;&lt;EOF
    {
      &#34;interfaces&#34;: [{
        &#34;networkName&#34;: &#34;%(network_name)s&#34;
      }]
    }
    EOF
&#39;&#39;&#39;
TF_USER_DATA = &#39;&#39;&#39;&lt;&lt;EOF
    #cloud-config
    password: password
    chpasswd: {expire: False}
    ssh_pwauth: True
    package_update: true
    packages:
      - qemu-guest-agent
      - iptables
    runcmd:
      - - systemctl
        - enable
        - &#39;--now&#39;
        - qemu-guest-agent.service
    EOF
&#39;&#39;&#39;


# rancher2_cluster_v2
TF_CLUSTER_CONFIG = &#39;&#39;&#39;
resource &#34;rancher2_cluster_v2&#34; &#34;%(name)s&#34; {
  name               = &#34;%(name)s&#34;
  kubernetes_version = &#34;%(rke2_version)s&#34;
  %(rke_config)s
}

&#39;&#39;&#39;

TF_RKE_CONFIG = &#39;&#39;&#39;
  rke_config {
    %(machine_pools)s
    machine_selector_config {
      config = {
        cloud-provider-config = file(&#34;${path.module}/kubeconfig&#34;)
        cloud-provider-name = &#34;harvester&#34;
      }
    }
    machine_global_config = &lt;&lt;EOF
    cni: &#34;calico&#34;
    disable-kube-proxy: false
    etcd-expose-metrics: false
    EOF
    upgrade_strategy {
      control_plane_concurrency = &#34;10%%&#34;
      worker_concurrency        = &#34;10%%&#34;
    }
    etcd {
      snapshot_schedule_cron = &#34;0 */5 * * *&#34;
      snapshot_retention     = 5
    }
    chart_values = &lt;&lt;EOF
    harvester-cloud-provider:
      clusterName: %(harvester_name)s
      cloudConfigPath: /var/lib/rancher/rke2/etc/config-files/cloud-provider-config
    EOF
}
&#39;&#39;&#39;
TF_MACHINE_POOLS = &#39;&#39;&#39;
    machine_pools {
      name                         = &#34;pool1&#34;
      cloud_credential_secret_name = rancher2_cloud_credential.%(cloud_credential_name)s.id
      control_plane_role           = true
      etcd_role                    = true
      worker_role                  = true
      quantity                     = 1
      machine_config {
        kind = rancher2_machine_config_v2.%(machine_config_name)s.kind
        name = rancher2_machine_config_v2.%(machine_config_name)s.name
      }
    }
&#39;&#39;&#39;


def remove_ansicode(ctx):
    if isinstance(ctx, bytes):
        ctx = ctx.decode()
    return re.sub(r&#34;\x1b|\[\d+m&#34;, &#34;&#34;, ctx)


@pytest.fixture(scope=&#34;session&#34;)
def tf_script_dir(request):
    return Path(request.config.getoption(&#39;--terraform-scripts-location&#39;))


@pytest.fixture(scope=&#34;session&#34;)
def tf_provider_version(request):
    version = request.config.getoption(&#39;--terraform-provider-harvester&#39;)
    if not version:
        import requests
        resp = requests.get(&#34;https://registry.terraform.io/v1/providers/harvester/harvester&#34;)
        version = max(resp.json()[&#39;versions&#39;], key=parse_version)
    return version


@pytest.fixture(scope=&#34;session&#34;)
def tf_provider_rancher_ver(request):
    version = request.config.getoption(&#39;--terraform-provider-rancher&#39;)
    if not version:
        import requests
        resp = requests.get(&#34;https://registry.terraform.io/v1/providers/rancher/rancher2&#34;)
        version = max(resp.json()[&#39;versions&#39;], key=parse_version)
    return version


@pytest.fixture(scope=&#34;session&#34;)
def tf_executor(tf_script_dir):
    run(str(tf_script_dir / &#34;terraform_install.sh&#34;), stdout=PIPE, stderr=PIPE)
    executor = tf_script_dir / &#34;bin/terraform&#34;
    assert executor.is_file()

    yield executor


@pytest.fixture(scope=&#34;session&#34;)
def tf_harvester(api_client, tf_script_dir, tf_provider_version, tf_executor):
    harv = TerraformHarvester(tf_executor, tf_script_dir / datetime.now().strftime(&#34;%Hh%Mm_%m-%d&#34;))
    kuebconfig = api_client.generate_kubeconfig()
    out, err, exc_code = harv.initial_provider(kuebconfig, tf_provider_version)
    assert not err and 0 == exc_code
    return harv


@pytest.fixture(scope=&#34;module&#34;)
def tf_rancher(rancher_api_client, tf_script_dir, tf_provider_rancher_ver, tf_executor,
               harvester, rancher):
    tf_rancher = TerraformRancher(tf_executor,
                                  tf_script_dir / datetime.now().strftime(&#34;%Hh%Mm_%m-%d&#34;))
    kubeconfig = rancher_api_client.generate_kubeconfig(harvester[&#34;id&#34;], harvester[&#34;name&#34;])

    out, err, exc_code = \
        tf_rancher.initial_provider(kubeconfig, tf_provider_rancher_ver, harvester, rancher)
    assert not err and 0 == exc_code
    return tf_rancher


@pytest.fixture(scope=&#34;session&#34;)
def tf_resource(tf_provider_version):
    converter = Path(&#34;./terraform_test_artifacts/json2hcl&#34;)
    return TerraformResource.for_version(tf_provider_version)(converter)


@pytest.fixture(scope=&#34;session&#34;)
def tf_rancher_resource(tf_provider_rancher_ver):
    converter = Path(&#34;./terraform_test_artifacts/json2hcl&#34;)
    return TerraformRancherResource.for_version(tf_provider_rancher_ver)(converter)


class TerraformHarvester:
    def __init__(self, executor, workdir):
        self.executor = executor.resolve()
        self.workdir = workdir
        self.workdir.mkdir(exist_ok=True)

    def exec_command(self, cmd, raw=False, **kws):
        rv = run(cmd, shell=True, stdout=PIPE, stderr=PIPE, cwd=self.workdir, **kws)

        if raw:
            return rv
        return remove_ansicode(rv.stdout), remove_ansicode(rv.stderr), rv.returncode

    def execute(self, cmd, raw=False, **kws):
        return self.exec_command(f&#34;{self.executor} {cmd}&#34;, raw=raw, **kws)

    def initial_provider(self, kubeconfig, provider_version):
        kubefile = self.workdir / &#34;kubeconfig&#34;
        with open(kubefile, &#34;w&#34;) as f:
            f.write(kubeconfig)

        with open(self.workdir / &#34;provider.tf&#34;, &#34;w&#34;) as f:
            f.write(TF_PROVIDER % dict(
                tf_version=&#34;&gt;=0.13&#34;, config_path=kubefile.resolve(),
                provider_source=&#34;harvester/harvester&#34;, provider_version=provider_version
            ))

        return self.execute(&#34;init&#34;)

    def save_as(self, content, filename, ext=&#34;.tf&#34;):
        filepath = self.workdir / f&#34;{filename}{ext}&#34;
        with open(filepath, &#34;w&#34;) as f:
            f.write(content)

    def apply_resource(self, resource_type, resource_name):
        return self.execute(f&#34;apply -auto-approve -target {resource_type}.{resource_name}&#34;)

    def destroy_resource(self, resource_type, resource_name):
        return self.execute(f&#34;destroy -auto-approve -target {resource_type}.{resource_name}&#34;)


class TerraformRancher(TerraformHarvester):
    def initial_provider(self, kubeconfig, provider_version, harvester, rancher):
        kubefile = self.workdir / &#34;kubeconfig&#34;
        with open(kubefile, &#34;w&#34;) as f:
            f.write(kubeconfig)

        with open(self.workdir / &#34;provider.tf&#34;, &#34;w&#34;) as f:
            f.write(TF_PROVIDER_RANCHER % {
                &#34;provider_source&#34;: &#34;rancher/rancher2&#34;,
                &#34;provider_version&#34;: provider_version,
                &#34;rancher_endpoint&#34;: rancher[&#34;endpoint&#34;],
                &#34;rancher_token&#34;: rancher[&#34;token&#34;],
                &#34;harvester_name&#34;: harvester[&#34;name&#34;]
            })

        return self.execute(&#34;init&#34;)


@dataclass
class ResourceContext:
    type: str
    name: str
    ctx: str
    raw: dict = field(default_factory=dict, compare=False)


class BaseTerraformResource:
    #: Be used to store sub classes of BaseTerraformResource
    #: Type: Dict[Type[BaseTerraformResource], List[Type[BaseTerraformResource]]]
    _sub_classes = dict()

    #: Be used to adjust whether the class is support to specific version
    #: Type: str
    support_to = &#34;0.0.0&#34;

    @classmethod
    def is_support(cls, target_version):
        return parse_version(target_version) &gt;= parse_version(cls.support_to)

    @classmethod
    def for_version(cls, version):
        for c in sorted(cls._sub_classes.get(cls, []),
                        reverse=True, key=lambda x: parse_version(x.support_to).release):
            if c.is_support(version):
                return c
        return cls

    def __init_subclass__(cls):
        for parent in cls.__mro__:
            if issubclass(parent, BaseTerraformResource):
                cls._sub_classes.setdefault(parent, []).append(cls)

    def __init__(self, converter):
        self.executor = Path(converter).resolve()

    def convert_to_hcl(self, json_spec, raw=False):
        rv = run(f&#34;echo {json.dumps(json_spec)!r} | {self.executor!s}&#34;,
                 shell=True, stdout=PIPE, stderr=PIPE)
        if raw:
            return rv
        if rv.stderr:
            raise TypeError(rv.stderr, rv.stdout, rv.returncode)
        out = rv.stdout.decode()
        out = re.sub(r&#39;&#34;resource&#34;&#39;, &#34;resource&#34;, out)    # resource should not quote
        out = re.sub(r&#34;\&#34;(.+?)\&#34; =&#34;, r&#34;\1 =&#34;, out)      # property should not quote
        out = re.sub(r&#39;&#34;(data\.\S+?)&#34;&#39;, r&#34;\1&#34;, out)     # data should not quote
        out = re.sub(r&#34;(.[^ ]+) = {&#34;, r&#34;\1 {&#34;, out)     # block should not have `=`
        return out

    def make_resource(self, resource_type, resource_name, *, convert=True, **properties):
        rv = dict(resource={resource_type: {resource_name: properties}})
        if convert:
            return ResourceContext(resource_type, resource_name, self.convert_to_hcl(rv), rv)
        return rv


class TerraformResource(BaseTerraformResource):
    &#39;&#39;&#39; https://github.com/harvester/terraform-provider-harvester/blob/v0.1.0/docs/resources/ &#39;&#39;&#39;
    support_to = &#34;0.1.0&#34;

    def ssh_key(self, resource_name, name, public_key, *, convert=True, **properties):
        return self.make_resource(
            &#34;harvester_ssh_key&#34;, resource_name, name=name, public_key=public_key,
            convert=convert, **properties
        )

    def volume(self, resource_name, name, size=1, *, convert=True, **properties):
        size = size if isinstance(size, str) else f&#34;{size}Gi&#34;
        return self.make_resource(
            &#34;harvester_volume&#34;, resource_name, name=name, size=size,
            convert=convert, **properties
        )

    def image_download(
        self, resource_name, name, display_name, url, *, convert=True, **properties
    ):
        return self.make_resource(
            &#34;harvester_image&#34;, resource_name, name=name, display_name=display_name, url=url,
            source_type=&#34;download&#34;, convert=convert, **properties
        )

    def image_export_from_volume(
        self, resource_name, name, display_name, pvc_name, pvc_namespace,
        *, convert=True, **properties
    ):
        return self.make_resource(
            &#34;harvester_image&#34;, resource_name, name=name, display_name=display_name,
            pvc_name=pvc_name, pvc_namespace=pvc_namespace, source_type=&#34;export-from-volume&#34;,
            convert=convert, **properties
        )

    def virtual_machine(self, resource_name, name, disks, nics, *, convert=True, **properties):
        disks.extend(properties.pop(&#34;disk&#34;, []))
        nics.extend(properties.pop(&#34;network_interface&#34;, []))
        return self.make_resource(
            &#34;harvester_virtualmachine&#34;, resource_name, name=name, disk=disks,
            network_interface=nics, convert=convert, **properties
        )

    vm = virtual_machine  # alias

    def network(self, resource_name, name, vlan_id, *, convert=True, **properties):
        return self.make_resource(
            &#34;harvester_network&#34;, resource_name, name=name, vlan_id=vlan_id,
            convert=convert, **properties
        )


class TerraformResource_060(TerraformResource):
    &#39;&#39;&#39; https://github.com/harvester/terraform-provider-harvester/blob/v0.6.0/docs/resources/ &#39;&#39;&#39;
    support_to = &#34;0.6.0&#34;

    def storage_class(
        self, resource_name, name, replicas=1, stale_timeout=30, migratable=&#34;true&#34;,
        *, convert=True, **properties
    ):
        params = {
                &#34;migratable&#34;: migratable,
                &#34;numberOfReplicas&#34;: str(replicas),
                &#34;staleReplicaTimeout&#34;: str(stale_timeout)
        }
        params.update(properties.pop(&#39;parameters&#39;, {}))
        return self.make_resource(
            &#34;harvester_storageclass&#34;, resource_name, name=name, parameters=params,
            convert=convert, **properties
        )

    def cluster_network(self, resource_name, name, *, convert=True, **properties):
        return self.make_resource(
            &#34;harvester_clusternetwork&#34;, resource_name, name=name, convert=convert, **properties
        )

    def vlanconfig(
        self, resource_name, name, cluster_network_name, nics, *, convert=True, **properties
    ):
        uplink = properties.pop(&#39;uplink&#39;, dict())
        uplink[&#39;nics&#39;] = nics

        return self.make_resource(
            &#34;harvester_vlanconfig&#34;, resource_name, name=name, uplink=uplink,
            cluster_network_name=cluster_network_name, convert=convert, **properties
        )

    def network(
        self, resource_name, name, vlan_id, cluster_network_name, *, convert=True, **properties
    ):
        return super().network(
            resource_name, name, vlan_id, cluster_network_name=cluster_network_name,
            convert=convert, **properties
        )


class TerraformResource_063(TerraformResource_060):
    &#39;&#39;&#39; https://github.com/harvester/terraform-provider-harvester/blob/v0.6.3/docs/resources/ &#39;&#39;&#39;

    support_to = &#34;0.6.3&#34;

    def cloudinit_secret(
        self, resource_name, name, user_data=&#34;&#34;, network_data=&#34;&#34;, *, convert=True, **properties
    ):
        return self.make_resource(
            &#34;harvester_cloudinit_secret&#34;, resource_name,
            user_data=user_data, network_data=network_data, convert=convert, **properties
        )


class TerraformRancherResource(BaseTerraformResource):
    &#39;&#39;&#39; https://github.com/rancher/terraform-provider-rancher2/tree/v1.20.0/docs/resources
    &#39;&#39;&#39;
    support_to = &#34;1.20.0&#34;

    def machine_config(self, rke_cluster_name, network_id, image_id, ssh_user):
        hcl_str = TF_MACHINE_CONFIG % {
            &#34;name&#34;: rke_cluster_name,
            &#34;harvester_config&#34;: TF_HARVESTER_CONFIG % {
                &#34;ssh_user&#34;: ssh_user,
                &#34;disk_info&#34;: TF_DISK_INFO % {&#34;image_name&#34;: image_id},
                &#34;network_info&#34;: TF_NETWORK_INFO % {&#34;network_name&#34;: network_id},
                &#34;user_data&#34;: TF_USER_DATA
            }
        }
        return ResourceContext(&#34;rancher2_machine_config_v2&#34;, rke_cluster_name, hcl_str, &#34;&#34;)

    def cluster_config(self, rke_cluster_name, k8s_version, harvester_name, cloud_credential_name):
        machine_pools = TF_MACHINE_POOLS % {
            &#34;cloud_credential_name&#34;: cloud_credential_name,
            &#34;machine_config_name&#34;: rke_cluster_name
        }
        rke_config = TF_RKE_CONFIG % {
            &#34;machine_pools&#34;: machine_pools,
            &#34;harvester_name&#34;: harvester_name
        }
        hcl_str = TF_CLUSTER_CONFIG % {
            &#34;name&#34;: rke_cluster_name,
            &#34;rke2_version&#34;: k8s_version,
            &#34;rke_config&#34;: rke_config
        }
        return ResourceContext(&#34;rancher2_cluster_v2&#34;, rke_cluster_name, hcl_str, &#34;&#34;)


class TerraformRancherResource_123(TerraformRancherResource):
    &#39;&#39;&#39; https://github.com/rancher/terraform-provider-rancher2/tree/v1.23.0/docs/resources
    &#39;&#39;&#39;
    support_to = &#34;1.23.0&#34;

    def cloud_credential(self, name, harvester_name, *, convert=True, **properties):
        harvester_credential_config = {
            &#34;cluster_id&#34;: f&#34;data.rancher2_cluster_v2.{harvester_name}.cluster_v1_id&#34;,
            &#34;cluster_type&#34;: &#34;imported&#34;,
            &#34;kubeconfig_content&#34;: f&#34;data.rancher2_cluster_v2.{harvester_name}.kube_config&#34;
        }
        return self.make_resource(&#34;rancher2_cloud_credential&#34;, name,
                                  name=name,
                                  harvester_credential_config=harvester_credential_config,
                                  convert=convert, **properties)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.remove_ansicode"><code class="name flex">
<span>def <span class="ident">remove_ansicode</span></span>(<span>ctx)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_ansicode(ctx):
    if isinstance(ctx, bytes):
        ctx = ctx.decode()
    return re.sub(r&#34;\x1b|\[\d+m&#34;, &#34;&#34;, ctx)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_executor"><code class="name flex">
<span>def <span class="ident">tf_executor</span></span>(<span>tf_script_dir)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_executor(tf_script_dir):
    run(str(tf_script_dir / &#34;terraform_install.sh&#34;), stdout=PIPE, stderr=PIPE)
    executor = tf_script_dir / &#34;bin/terraform&#34;
    assert executor.is_file()

    yield executor</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_harvester"><code class="name flex">
<span>def <span class="ident">tf_harvester</span></span>(<span>api_client, tf_script_dir, tf_provider_version, tf_executor)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_harvester(api_client, tf_script_dir, tf_provider_version, tf_executor):
    harv = TerraformHarvester(tf_executor, tf_script_dir / datetime.now().strftime(&#34;%Hh%Mm_%m-%d&#34;))
    kuebconfig = api_client.generate_kubeconfig()
    out, err, exc_code = harv.initial_provider(kuebconfig, tf_provider_version)
    assert not err and 0 == exc_code
    return harv</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_provider_rancher_ver"><code class="name flex">
<span>def <span class="ident">tf_provider_rancher_ver</span></span>(<span>request)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_provider_rancher_ver(request):
    version = request.config.getoption(&#39;--terraform-provider-rancher&#39;)
    if not version:
        import requests
        resp = requests.get(&#34;https://registry.terraform.io/v1/providers/rancher/rancher2&#34;)
        version = max(resp.json()[&#39;versions&#39;], key=parse_version)
    return version</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_provider_version"><code class="name flex">
<span>def <span class="ident">tf_provider_version</span></span>(<span>request)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_provider_version(request):
    version = request.config.getoption(&#39;--terraform-provider-harvester&#39;)
    if not version:
        import requests
        resp = requests.get(&#34;https://registry.terraform.io/v1/providers/harvester/harvester&#34;)
        version = max(resp.json()[&#39;versions&#39;], key=parse_version)
    return version</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_rancher"><code class="name flex">
<span>def <span class="ident">tf_rancher</span></span>(<span>rancher_api_client, tf_script_dir, tf_provider_rancher_ver, tf_executor, harvester, rancher)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;module&#34;)
def tf_rancher(rancher_api_client, tf_script_dir, tf_provider_rancher_ver, tf_executor,
               harvester, rancher):
    tf_rancher = TerraformRancher(tf_executor,
                                  tf_script_dir / datetime.now().strftime(&#34;%Hh%Mm_%m-%d&#34;))
    kubeconfig = rancher_api_client.generate_kubeconfig(harvester[&#34;id&#34;], harvester[&#34;name&#34;])

    out, err, exc_code = \
        tf_rancher.initial_provider(kubeconfig, tf_provider_rancher_ver, harvester, rancher)
    assert not err and 0 == exc_code
    return tf_rancher</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_rancher_resource"><code class="name flex">
<span>def <span class="ident">tf_rancher_resource</span></span>(<span>tf_provider_rancher_ver)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_rancher_resource(tf_provider_rancher_ver):
    converter = Path(&#34;./terraform_test_artifacts/json2hcl&#34;)
    return TerraformRancherResource.for_version(tf_provider_rancher_ver)(converter)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_resource"><code class="name flex">
<span>def <span class="ident">tf_resource</span></span>(<span>tf_provider_version)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_resource(tf_provider_version):
    converter = Path(&#34;./terraform_test_artifacts/json2hcl&#34;)
    return TerraformResource.for_version(tf_provider_version)(converter)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.tf_script_dir"><code class="name flex">
<span>def <span class="ident">tf_script_dir</span></span>(<span>request)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@pytest.fixture(scope=&#34;session&#34;)
def tf_script_dir(request):
    return Path(request.config.getoption(&#39;--terraform-scripts-location&#39;))</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource"><code class="flex name class">
<span>class <span class="ident">BaseTerraformResource</span></span>
<span>(</span><span>converter)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BaseTerraformResource:
    #: Be used to store sub classes of BaseTerraformResource
    #: Type: Dict[Type[BaseTerraformResource], List[Type[BaseTerraformResource]]]
    _sub_classes = dict()

    #: Be used to adjust whether the class is support to specific version
    #: Type: str
    support_to = &#34;0.0.0&#34;

    @classmethod
    def is_support(cls, target_version):
        return parse_version(target_version) &gt;= parse_version(cls.support_to)

    @classmethod
    def for_version(cls, version):
        for c in sorted(cls._sub_classes.get(cls, []),
                        reverse=True, key=lambda x: parse_version(x.support_to).release):
            if c.is_support(version):
                return c
        return cls

    def __init_subclass__(cls):
        for parent in cls.__mro__:
            if issubclass(parent, BaseTerraformResource):
                cls._sub_classes.setdefault(parent, []).append(cls)

    def __init__(self, converter):
        self.executor = Path(converter).resolve()

    def convert_to_hcl(self, json_spec, raw=False):
        rv = run(f&#34;echo {json.dumps(json_spec)!r} | {self.executor!s}&#34;,
                 shell=True, stdout=PIPE, stderr=PIPE)
        if raw:
            return rv
        if rv.stderr:
            raise TypeError(rv.stderr, rv.stdout, rv.returncode)
        out = rv.stdout.decode()
        out = re.sub(r&#39;&#34;resource&#34;&#39;, &#34;resource&#34;, out)    # resource should not quote
        out = re.sub(r&#34;\&#34;(.+?)\&#34; =&#34;, r&#34;\1 =&#34;, out)      # property should not quote
        out = re.sub(r&#39;&#34;(data\.\S+?)&#34;&#39;, r&#34;\1&#34;, out)     # data should not quote
        out = re.sub(r&#34;(.[^ ]+) = {&#34;, r&#34;\1 {&#34;, out)     # block should not have `=`
        return out

    def make_resource(self, resource_type, resource_name, *, convert=True, **properties):
        rv = dict(resource={resource_type: {resource_name: properties}})
        if convert:
            return ResourceContext(resource_type, resource_name, self.convert_to_hcl(rv), rv)
        return rv</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource">TerraformRancherResource</a></li>
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource">TerraformResource</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to"><code class="name">var <span class="ident">support_to</span></code></dt>
<dd>
<div class="desc"><p>Be used to adjust whether the class is support to specific version
Type: str</p></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.for_version"><code class="name flex">
<span>def <span class="ident">for_version</span></span>(<span>version)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def for_version(cls, version):
    for c in sorted(cls._sub_classes.get(cls, []),
                    reverse=True, key=lambda x: parse_version(x.support_to).release):
        if c.is_support(version):
            return c
    return cls</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.is_support"><code class="name flex">
<span>def <span class="ident">is_support</span></span>(<span>target_version)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def is_support(cls, target_version):
    return parse_version(target_version) &gt;= parse_version(cls.support_to)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.convert_to_hcl"><code class="name flex">
<span>def <span class="ident">convert_to_hcl</span></span>(<span>self, json_spec, raw=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def convert_to_hcl(self, json_spec, raw=False):
    rv = run(f&#34;echo {json.dumps(json_spec)!r} | {self.executor!s}&#34;,
             shell=True, stdout=PIPE, stderr=PIPE)
    if raw:
        return rv
    if rv.stderr:
        raise TypeError(rv.stderr, rv.stdout, rv.returncode)
    out = rv.stdout.decode()
    out = re.sub(r&#39;&#34;resource&#34;&#39;, &#34;resource&#34;, out)    # resource should not quote
    out = re.sub(r&#34;\&#34;(.+?)\&#34; =&#34;, r&#34;\1 =&#34;, out)      # property should not quote
    out = re.sub(r&#39;&#34;(data\.\S+?)&#34;&#39;, r&#34;\1&#34;, out)     # data should not quote
    out = re.sub(r&#34;(.[^ ]+) = {&#34;, r&#34;\1 {&#34;, out)     # block should not have `=`
    return out</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.make_resource"><code class="name flex">
<span>def <span class="ident">make_resource</span></span>(<span>self, resource_type, resource_name, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def make_resource(self, resource_type, resource_name, *, convert=True, **properties):
    rv = dict(resource={resource_type: {resource_name: properties}})
    if convert:
        return ResourceContext(resource_type, resource_name, self.convert_to_hcl(rv), rv)
    return rv</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.ResourceContext"><code class="flex name class">
<span>class <span class="ident">ResourceContext</span></span>
<span>(</span><span>type: str, name: str, ctx: str, raw: dict = &lt;factory&gt;)</span>
</code></dt>
<dd>
<div class="desc"><p>ResourceContext(type: str, name: str, ctx: str, raw: dict = <factory>)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class ResourceContext:
    type: str
    name: str
    ctx: str
    raw: dict = field(default_factory=dict, compare=False)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.ResourceContext.ctx"><code class="name">var <span class="ident">ctx</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.ResourceContext.name"><code class="name">var <span class="ident">name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.ResourceContext.raw"><code class="name">var <span class="ident">raw</span> : dict</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.ResourceContext.type"><code class="name">var <span class="ident">type</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester"><code class="flex name class">
<span>class <span class="ident">TerraformHarvester</span></span>
<span>(</span><span>executor, workdir)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformHarvester:
    def __init__(self, executor, workdir):
        self.executor = executor.resolve()
        self.workdir = workdir
        self.workdir.mkdir(exist_ok=True)

    def exec_command(self, cmd, raw=False, **kws):
        rv = run(cmd, shell=True, stdout=PIPE, stderr=PIPE, cwd=self.workdir, **kws)

        if raw:
            return rv
        return remove_ansicode(rv.stdout), remove_ansicode(rv.stderr), rv.returncode

    def execute(self, cmd, raw=False, **kws):
        return self.exec_command(f&#34;{self.executor} {cmd}&#34;, raw=raw, **kws)

    def initial_provider(self, kubeconfig, provider_version):
        kubefile = self.workdir / &#34;kubeconfig&#34;
        with open(kubefile, &#34;w&#34;) as f:
            f.write(kubeconfig)

        with open(self.workdir / &#34;provider.tf&#34;, &#34;w&#34;) as f:
            f.write(TF_PROVIDER % dict(
                tf_version=&#34;&gt;=0.13&#34;, config_path=kubefile.resolve(),
                provider_source=&#34;harvester/harvester&#34;, provider_version=provider_version
            ))

        return self.execute(&#34;init&#34;)

    def save_as(self, content, filename, ext=&#34;.tf&#34;):
        filepath = self.workdir / f&#34;{filename}{ext}&#34;
        with open(filepath, &#34;w&#34;) as f:
            f.write(content)

    def apply_resource(self, resource_type, resource_name):
        return self.execute(f&#34;apply -auto-approve -target {resource_type}.{resource_name}&#34;)

    def destroy_resource(self, resource_type, resource_name):
        return self.execute(f&#34;destroy -auto-approve -target {resource_type}.{resource_name}&#34;)</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancher" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancher">TerraformRancher</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.apply_resource"><code class="name flex">
<span>def <span class="ident">apply_resource</span></span>(<span>self, resource_type, resource_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def apply_resource(self, resource_type, resource_name):
    return self.execute(f&#34;apply -auto-approve -target {resource_type}.{resource_name}&#34;)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.destroy_resource"><code class="name flex">
<span>def <span class="ident">destroy_resource</span></span>(<span>self, resource_type, resource_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def destroy_resource(self, resource_type, resource_name):
    return self.execute(f&#34;destroy -auto-approve -target {resource_type}.{resource_name}&#34;)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.exec_command"><code class="name flex">
<span>def <span class="ident">exec_command</span></span>(<span>self, cmd, raw=False, **kws)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def exec_command(self, cmd, raw=False, **kws):
    rv = run(cmd, shell=True, stdout=PIPE, stderr=PIPE, cwd=self.workdir, **kws)

    if raw:
        return rv
    return remove_ansicode(rv.stdout), remove_ansicode(rv.stderr), rv.returncode</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.execute"><code class="name flex">
<span>def <span class="ident">execute</span></span>(<span>self, cmd, raw=False, **kws)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def execute(self, cmd, raw=False, **kws):
    return self.exec_command(f&#34;{self.executor} {cmd}&#34;, raw=raw, **kws)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.initial_provider"><code class="name flex">
<span>def <span class="ident">initial_provider</span></span>(<span>self, kubeconfig, provider_version)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def initial_provider(self, kubeconfig, provider_version):
    kubefile = self.workdir / &#34;kubeconfig&#34;
    with open(kubefile, &#34;w&#34;) as f:
        f.write(kubeconfig)

    with open(self.workdir / &#34;provider.tf&#34;, &#34;w&#34;) as f:
        f.write(TF_PROVIDER % dict(
            tf_version=&#34;&gt;=0.13&#34;, config_path=kubefile.resolve(),
            provider_source=&#34;harvester/harvester&#34;, provider_version=provider_version
        ))

    return self.execute(&#34;init&#34;)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.save_as"><code class="name flex">
<span>def <span class="ident">save_as</span></span>(<span>self, content, filename, ext='.tf')</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_as(self, content, filename, ext=&#34;.tf&#34;):
    filepath = self.workdir / f&#34;{filename}{ext}&#34;
    with open(filepath, &#34;w&#34;) as f:
        f.write(content)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancher"><code class="flex name class">
<span>class <span class="ident">TerraformRancher</span></span>
<span>(</span><span>executor, workdir)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformRancher(TerraformHarvester):
    def initial_provider(self, kubeconfig, provider_version, harvester, rancher):
        kubefile = self.workdir / &#34;kubeconfig&#34;
        with open(kubefile, &#34;w&#34;) as f:
            f.write(kubeconfig)

        with open(self.workdir / &#34;provider.tf&#34;, &#34;w&#34;) as f:
            f.write(TF_PROVIDER_RANCHER % {
                &#34;provider_source&#34;: &#34;rancher/rancher2&#34;,
                &#34;provider_version&#34;: provider_version,
                &#34;rancher_endpoint&#34;: rancher[&#34;endpoint&#34;],
                &#34;rancher_token&#34;: rancher[&#34;token&#34;],
                &#34;harvester_name&#34;: harvester[&#34;name&#34;]
            })

        return self.execute(&#34;init&#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester">TerraformHarvester</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancher.initial_provider"><code class="name flex">
<span>def <span class="ident">initial_provider</span></span>(<span>self, kubeconfig, provider_version, harvester, rancher)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def initial_provider(self, kubeconfig, provider_version, harvester, rancher):
    kubefile = self.workdir / &#34;kubeconfig&#34;
    with open(kubefile, &#34;w&#34;) as f:
        f.write(kubeconfig)

    with open(self.workdir / &#34;provider.tf&#34;, &#34;w&#34;) as f:
        f.write(TF_PROVIDER_RANCHER % {
            &#34;provider_source&#34;: &#34;rancher/rancher2&#34;,
            &#34;provider_version&#34;: provider_version,
            &#34;rancher_endpoint&#34;: rancher[&#34;endpoint&#34;],
            &#34;rancher_token&#34;: rancher[&#34;token&#34;],
            &#34;harvester_name&#34;: harvester[&#34;name&#34;]
        })

    return self.execute(&#34;init&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource"><code class="flex name class">
<span>class <span class="ident">TerraformRancherResource</span></span>
<span>(</span><span>converter)</span>
</code></dt>
<dd>
<div class="desc"><p><a href="https://github.com/rancher/terraform-provider-rancher2/tree/v1.20.0/docs/resources">https://github.com/rancher/terraform-provider-rancher2/tree/v1.20.0/docs/resources</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformRancherResource(BaseTerraformResource):
    &#39;&#39;&#39; https://github.com/rancher/terraform-provider-rancher2/tree/v1.20.0/docs/resources
    &#39;&#39;&#39;
    support_to = &#34;1.20.0&#34;

    def machine_config(self, rke_cluster_name, network_id, image_id, ssh_user):
        hcl_str = TF_MACHINE_CONFIG % {
            &#34;name&#34;: rke_cluster_name,
            &#34;harvester_config&#34;: TF_HARVESTER_CONFIG % {
                &#34;ssh_user&#34;: ssh_user,
                &#34;disk_info&#34;: TF_DISK_INFO % {&#34;image_name&#34;: image_id},
                &#34;network_info&#34;: TF_NETWORK_INFO % {&#34;network_name&#34;: network_id},
                &#34;user_data&#34;: TF_USER_DATA
            }
        }
        return ResourceContext(&#34;rancher2_machine_config_v2&#34;, rke_cluster_name, hcl_str, &#34;&#34;)

    def cluster_config(self, rke_cluster_name, k8s_version, harvester_name, cloud_credential_name):
        machine_pools = TF_MACHINE_POOLS % {
            &#34;cloud_credential_name&#34;: cloud_credential_name,
            &#34;machine_config_name&#34;: rke_cluster_name
        }
        rke_config = TF_RKE_CONFIG % {
            &#34;machine_pools&#34;: machine_pools,
            &#34;harvester_name&#34;: harvester_name
        }
        hcl_str = TF_CLUSTER_CONFIG % {
            &#34;name&#34;: rke_cluster_name,
            &#34;rke2_version&#34;: k8s_version,
            &#34;rke_config&#34;: rke_config
        }
        return ResourceContext(&#34;rancher2_cluster_v2&#34;, rke_cluster_name, hcl_str, &#34;&#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123">TerraformRancherResource_123</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource.cluster_config"><code class="name flex">
<span>def <span class="ident">cluster_config</span></span>(<span>self, rke_cluster_name, k8s_version, harvester_name, cloud_credential_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def cluster_config(self, rke_cluster_name, k8s_version, harvester_name, cloud_credential_name):
    machine_pools = TF_MACHINE_POOLS % {
        &#34;cloud_credential_name&#34;: cloud_credential_name,
        &#34;machine_config_name&#34;: rke_cluster_name
    }
    rke_config = TF_RKE_CONFIG % {
        &#34;machine_pools&#34;: machine_pools,
        &#34;harvester_name&#34;: harvester_name
    }
    hcl_str = TF_CLUSTER_CONFIG % {
        &#34;name&#34;: rke_cluster_name,
        &#34;rke2_version&#34;: k8s_version,
        &#34;rke_config&#34;: rke_config
    }
    return ResourceContext(&#34;rancher2_cluster_v2&#34;, rke_cluster_name, hcl_str, &#34;&#34;)</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource.machine_config"><code class="name flex">
<span>def <span class="ident">machine_config</span></span>(<span>self, rke_cluster_name, network_id, image_id, ssh_user)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def machine_config(self, rke_cluster_name, network_id, image_id, ssh_user):
    hcl_str = TF_MACHINE_CONFIG % {
        &#34;name&#34;: rke_cluster_name,
        &#34;harvester_config&#34;: TF_HARVESTER_CONFIG % {
            &#34;ssh_user&#34;: ssh_user,
            &#34;disk_info&#34;: TF_DISK_INFO % {&#34;image_name&#34;: image_id},
            &#34;network_info&#34;: TF_NETWORK_INFO % {&#34;network_name&#34;: network_id},
            &#34;user_data&#34;: TF_USER_DATA
        }
    }
    return ResourceContext(&#34;rancher2_machine_config_v2&#34;, rke_cluster_name, hcl_str, &#34;&#34;)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></b></code>:
<ul class="hlist">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to">support_to</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123"><code class="flex name class">
<span>class <span class="ident">TerraformRancherResource_123</span></span>
<span>(</span><span>converter)</span>
</code></dt>
<dd>
<div class="desc"><p><a href="https://github.com/rancher/terraform-provider-rancher2/tree/v1.23.0/docs/resources">https://github.com/rancher/terraform-provider-rancher2/tree/v1.23.0/docs/resources</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformRancherResource_123(TerraformRancherResource):
    &#39;&#39;&#39; https://github.com/rancher/terraform-provider-rancher2/tree/v1.23.0/docs/resources
    &#39;&#39;&#39;
    support_to = &#34;1.23.0&#34;

    def cloud_credential(self, name, harvester_name, *, convert=True, **properties):
        harvester_credential_config = {
            &#34;cluster_id&#34;: f&#34;data.rancher2_cluster_v2.{harvester_name}.cluster_v1_id&#34;,
            &#34;cluster_type&#34;: &#34;imported&#34;,
            &#34;kubeconfig_content&#34;: f&#34;data.rancher2_cluster_v2.{harvester_name}.kube_config&#34;
        }
        return self.make_resource(&#34;rancher2_cloud_credential&#34;, name,
                                  name=name,
                                  harvester_credential_config=harvester_credential_config,
                                  convert=convert, **properties)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource">TerraformRancherResource</a></li>
<li><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123.cloud_credential"><code class="name flex">
<span>def <span class="ident">cloud_credential</span></span>(<span>self, name, harvester_name, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def cloud_credential(self, name, harvester_name, *, convert=True, **properties):
    harvester_credential_config = {
        &#34;cluster_id&#34;: f&#34;data.rancher2_cluster_v2.{harvester_name}.cluster_v1_id&#34;,
        &#34;cluster_type&#34;: &#34;imported&#34;,
        &#34;kubeconfig_content&#34;: f&#34;data.rancher2_cluster_v2.{harvester_name}.kube_config&#34;
    }
    return self.make_resource(&#34;rancher2_cloud_credential&#34;, name,
                              name=name,
                              harvester_credential_config=harvester_credential_config,
                              convert=convert, **properties)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></b></code>:
<ul class="hlist">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to">support_to</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource"><code class="flex name class">
<span>class <span class="ident">TerraformResource</span></span>
<span>(</span><span>converter)</span>
</code></dt>
<dd>
<div class="desc"><p><a href="https://github.com/harvester/terraform-provider-harvester/blob/v0.1.0/docs/resources/">https://github.com/harvester/terraform-provider-harvester/blob/v0.1.0/docs/resources/</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformResource(BaseTerraformResource):
    &#39;&#39;&#39; https://github.com/harvester/terraform-provider-harvester/blob/v0.1.0/docs/resources/ &#39;&#39;&#39;
    support_to = &#34;0.1.0&#34;

    def ssh_key(self, resource_name, name, public_key, *, convert=True, **properties):
        return self.make_resource(
            &#34;harvester_ssh_key&#34;, resource_name, name=name, public_key=public_key,
            convert=convert, **properties
        )

    def volume(self, resource_name, name, size=1, *, convert=True, **properties):
        size = size if isinstance(size, str) else f&#34;{size}Gi&#34;
        return self.make_resource(
            &#34;harvester_volume&#34;, resource_name, name=name, size=size,
            convert=convert, **properties
        )

    def image_download(
        self, resource_name, name, display_name, url, *, convert=True, **properties
    ):
        return self.make_resource(
            &#34;harvester_image&#34;, resource_name, name=name, display_name=display_name, url=url,
            source_type=&#34;download&#34;, convert=convert, **properties
        )

    def image_export_from_volume(
        self, resource_name, name, display_name, pvc_name, pvc_namespace,
        *, convert=True, **properties
    ):
        return self.make_resource(
            &#34;harvester_image&#34;, resource_name, name=name, display_name=display_name,
            pvc_name=pvc_name, pvc_namespace=pvc_namespace, source_type=&#34;export-from-volume&#34;,
            convert=convert, **properties
        )

    def virtual_machine(self, resource_name, name, disks, nics, *, convert=True, **properties):
        disks.extend(properties.pop(&#34;disk&#34;, []))
        nics.extend(properties.pop(&#34;network_interface&#34;, []))
        return self.make_resource(
            &#34;harvester_virtualmachine&#34;, resource_name, name=name, disk=disks,
            network_interface=nics, convert=convert, **properties
        )

    vm = virtual_machine  # alias

    def network(self, resource_name, name, vlan_id, *, convert=True, **properties):
        return self.make_resource(
            &#34;harvester_network&#34;, resource_name, name=name, vlan_id=vlan_id,
            convert=convert, **properties
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060">TerraformResource_060</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.image_download"><code class="name flex">
<span>def <span class="ident">image_download</span></span>(<span>self, resource_name, name, display_name, url, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def image_download(
    self, resource_name, name, display_name, url, *, convert=True, **properties
):
    return self.make_resource(
        &#34;harvester_image&#34;, resource_name, name=name, display_name=display_name, url=url,
        source_type=&#34;download&#34;, convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.image_export_from_volume"><code class="name flex">
<span>def <span class="ident">image_export_from_volume</span></span>(<span>self, resource_name, name, display_name, pvc_name, pvc_namespace, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def image_export_from_volume(
    self, resource_name, name, display_name, pvc_name, pvc_namespace,
    *, convert=True, **properties
):
    return self.make_resource(
        &#34;harvester_image&#34;, resource_name, name=name, display_name=display_name,
        pvc_name=pvc_name, pvc_namespace=pvc_namespace, source_type=&#34;export-from-volume&#34;,
        convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.network"><code class="name flex">
<span>def <span class="ident">network</span></span>(<span>self, resource_name, name, vlan_id, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def network(self, resource_name, name, vlan_id, *, convert=True, **properties):
    return self.make_resource(
        &#34;harvester_network&#34;, resource_name, name=name, vlan_id=vlan_id,
        convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.ssh_key"><code class="name flex">
<span>def <span class="ident">ssh_key</span></span>(<span>self, resource_name, name, public_key, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def ssh_key(self, resource_name, name, public_key, *, convert=True, **properties):
    return self.make_resource(
        &#34;harvester_ssh_key&#34;, resource_name, name=name, public_key=public_key,
        convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.virtual_machine"><code class="name flex">
<span>def <span class="ident">virtual_machine</span></span>(<span>self, resource_name, name, disks, nics, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def virtual_machine(self, resource_name, name, disks, nics, *, convert=True, **properties):
    disks.extend(properties.pop(&#34;disk&#34;, []))
    nics.extend(properties.pop(&#34;network_interface&#34;, []))
    return self.make_resource(
        &#34;harvester_virtualmachine&#34;, resource_name, name=name, disk=disks,
        network_interface=nics, convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.vm"><code class="name flex">
<span>def <span class="ident">vm</span></span>(<span>self, resource_name, name, disks, nics, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def virtual_machine(self, resource_name, name, disks, nics, *, convert=True, **properties):
    disks.extend(properties.pop(&#34;disk&#34;, []))
    nics.extend(properties.pop(&#34;network_interface&#34;, []))
    return self.make_resource(
        &#34;harvester_virtualmachine&#34;, resource_name, name=name, disk=disks,
        network_interface=nics, convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource.volume"><code class="name flex">
<span>def <span class="ident">volume</span></span>(<span>self, resource_name, name, size=1, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def volume(self, resource_name, name, size=1, *, convert=True, **properties):
    size = size if isinstance(size, str) else f&#34;{size}Gi&#34;
    return self.make_resource(
        &#34;harvester_volume&#34;, resource_name, name=name, size=size,
        convert=convert, **properties
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></b></code>:
<ul class="hlist">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to">support_to</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_060"><code class="flex name class">
<span>class <span class="ident">TerraformResource_060</span></span>
<span>(</span><span>converter)</span>
</code></dt>
<dd>
<div class="desc"><p><a href="https://github.com/harvester/terraform-provider-harvester/blob/v0.6.0/docs/resources/">https://github.com/harvester/terraform-provider-harvester/blob/v0.6.0/docs/resources/</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformResource_060(TerraformResource):
    &#39;&#39;&#39; https://github.com/harvester/terraform-provider-harvester/blob/v0.6.0/docs/resources/ &#39;&#39;&#39;
    support_to = &#34;0.6.0&#34;

    def storage_class(
        self, resource_name, name, replicas=1, stale_timeout=30, migratable=&#34;true&#34;,
        *, convert=True, **properties
    ):
        params = {
                &#34;migratable&#34;: migratable,
                &#34;numberOfReplicas&#34;: str(replicas),
                &#34;staleReplicaTimeout&#34;: str(stale_timeout)
        }
        params.update(properties.pop(&#39;parameters&#39;, {}))
        return self.make_resource(
            &#34;harvester_storageclass&#34;, resource_name, name=name, parameters=params,
            convert=convert, **properties
        )

    def cluster_network(self, resource_name, name, *, convert=True, **properties):
        return self.make_resource(
            &#34;harvester_clusternetwork&#34;, resource_name, name=name, convert=convert, **properties
        )

    def vlanconfig(
        self, resource_name, name, cluster_network_name, nics, *, convert=True, **properties
    ):
        uplink = properties.pop(&#39;uplink&#39;, dict())
        uplink[&#39;nics&#39;] = nics

        return self.make_resource(
            &#34;harvester_vlanconfig&#34;, resource_name, name=name, uplink=uplink,
            cluster_network_name=cluster_network_name, convert=convert, **properties
        )

    def network(
        self, resource_name, name, vlan_id, cluster_network_name, *, convert=True, **properties
    ):
        return super().network(
            resource_name, name, vlan_id, cluster_network_name=cluster_network_name,
            convert=convert, **properties
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource">TerraformResource</a></li>
<li><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_063" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_063">TerraformResource_063</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.cluster_network"><code class="name flex">
<span>def <span class="ident">cluster_network</span></span>(<span>self, resource_name, name, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def cluster_network(self, resource_name, name, *, convert=True, **properties):
    return self.make_resource(
        &#34;harvester_clusternetwork&#34;, resource_name, name=name, convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.network"><code class="name flex">
<span>def <span class="ident">network</span></span>(<span>self, resource_name, name, vlan_id, cluster_network_name, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def network(
    self, resource_name, name, vlan_id, cluster_network_name, *, convert=True, **properties
):
    return super().network(
        resource_name, name, vlan_id, cluster_network_name=cluster_network_name,
        convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.storage_class"><code class="name flex">
<span>def <span class="ident">storage_class</span></span>(<span>self, resource_name, name, replicas=1, stale_timeout=30, migratable='true', *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def storage_class(
    self, resource_name, name, replicas=1, stale_timeout=30, migratable=&#34;true&#34;,
    *, convert=True, **properties
):
    params = {
            &#34;migratable&#34;: migratable,
            &#34;numberOfReplicas&#34;: str(replicas),
            &#34;staleReplicaTimeout&#34;: str(stale_timeout)
    }
    params.update(properties.pop(&#39;parameters&#39;, {}))
    return self.make_resource(
        &#34;harvester_storageclass&#34;, resource_name, name=name, parameters=params,
        convert=convert, **properties
    )</code></pre>
</details>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.vlanconfig"><code class="name flex">
<span>def <span class="ident">vlanconfig</span></span>(<span>self, resource_name, name, cluster_network_name, nics, *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vlanconfig(
    self, resource_name, name, cluster_network_name, nics, *, convert=True, **properties
):
    uplink = properties.pop(&#39;uplink&#39;, dict())
    uplink[&#39;nics&#39;] = nics

    return self.make_resource(
        &#34;harvester_vlanconfig&#34;, resource_name, name=name, uplink=uplink,
        cluster_network_name=cluster_network_name, convert=convert, **properties
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></b></code>:
<ul class="hlist">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to">support_to</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_063"><code class="flex name class">
<span>class <span class="ident">TerraformResource_063</span></span>
<span>(</span><span>converter)</span>
</code></dt>
<dd>
<div class="desc"><p><a href="https://github.com/harvester/terraform-provider-harvester/blob/v0.6.3/docs/resources/">https://github.com/harvester/terraform-provider-harvester/blob/v0.6.3/docs/resources/</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TerraformResource_063(TerraformResource_060):
    &#39;&#39;&#39; https://github.com/harvester/terraform-provider-harvester/blob/v0.6.3/docs/resources/ &#39;&#39;&#39;

    support_to = &#34;0.6.3&#34;

    def cloudinit_secret(
        self, resource_name, name, user_data=&#34;&#34;, network_data=&#34;&#34;, *, convert=True, **properties
    ):
        return self.make_resource(
            &#34;harvester_cloudinit_secret&#34;, resource_name,
            user_data=user_data, network_data=network_data, convert=convert, **properties
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060">TerraformResource_060</a></li>
<li><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource">TerraformResource</a></li>
<li><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="harvester_e2e_tests.fixtures.terraform.TerraformResource_063.cloudinit_secret"><code class="name flex">
<span>def <span class="ident">cloudinit_secret</span></span>(<span>self, resource_name, name, user_data='', network_data='', *, convert=True, **properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def cloudinit_secret(
    self, resource_name, name, user_data=&#34;&#34;, network_data=&#34;&#34;, *, convert=True, **properties
):
    return self.make_resource(
        &#34;harvester_cloudinit_secret&#34;, resource_name,
        user_data=user_data, network_data=network_data, convert=convert, **properties
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></b></code>:
<ul class="hlist">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to">support_to</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="harvester_e2e_tests.fixtures" href="index.html">harvester_e2e_tests.fixtures</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.remove_ansicode" href="#harvester_e2e_tests.fixtures.terraform.remove_ansicode">remove_ansicode</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_executor" href="#harvester_e2e_tests.fixtures.terraform.tf_executor">tf_executor</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_harvester" href="#harvester_e2e_tests.fixtures.terraform.tf_harvester">tf_harvester</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_provider_rancher_ver" href="#harvester_e2e_tests.fixtures.terraform.tf_provider_rancher_ver">tf_provider_rancher_ver</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_provider_version" href="#harvester_e2e_tests.fixtures.terraform.tf_provider_version">tf_provider_version</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_rancher" href="#harvester_e2e_tests.fixtures.terraform.tf_rancher">tf_rancher</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_rancher_resource" href="#harvester_e2e_tests.fixtures.terraform.tf_rancher_resource">tf_rancher_resource</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_resource" href="#harvester_e2e_tests.fixtures.terraform.tf_resource">tf_resource</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.tf_script_dir" href="#harvester_e2e_tests.fixtures.terraform.tf_script_dir">tf_script_dir</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource">BaseTerraformResource</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.convert_to_hcl" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.convert_to_hcl">convert_to_hcl</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.for_version" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.for_version">for_version</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.is_support" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.is_support">is_support</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.make_resource" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.make_resource">make_resource</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to" href="#harvester_e2e_tests.fixtures.terraform.BaseTerraformResource.support_to">support_to</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.ResourceContext" href="#harvester_e2e_tests.fixtures.terraform.ResourceContext">ResourceContext</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.ResourceContext.ctx" href="#harvester_e2e_tests.fixtures.terraform.ResourceContext.ctx">ctx</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.ResourceContext.name" href="#harvester_e2e_tests.fixtures.terraform.ResourceContext.name">name</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.ResourceContext.raw" href="#harvester_e2e_tests.fixtures.terraform.ResourceContext.raw">raw</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.ResourceContext.type" href="#harvester_e2e_tests.fixtures.terraform.ResourceContext.type">type</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester">TerraformHarvester</a></code></h4>
<ul class="two-column">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.apply_resource" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester.apply_resource">apply_resource</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.destroy_resource" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester.destroy_resource">destroy_resource</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.exec_command" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester.exec_command">exec_command</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.execute" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester.execute">execute</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.initial_provider" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester.initial_provider">initial_provider</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformHarvester.save_as" href="#harvester_e2e_tests.fixtures.terraform.TerraformHarvester.save_as">save_as</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancher" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancher">TerraformRancher</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancher.initial_provider" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancher.initial_provider">initial_provider</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource">TerraformRancherResource</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource.cluster_config" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource.cluster_config">cluster_config</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource.machine_config" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource.machine_config">machine_config</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123">TerraformRancherResource_123</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123.cloud_credential" href="#harvester_e2e_tests.fixtures.terraform.TerraformRancherResource_123.cloud_credential">cloud_credential</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource">TerraformResource</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.image_download" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.image_download">image_download</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.image_export_from_volume" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.image_export_from_volume">image_export_from_volume</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.network" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.network">network</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.ssh_key" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.ssh_key">ssh_key</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.virtual_machine" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.virtual_machine">virtual_machine</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.vm" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.vm">vm</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource.volume" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource.volume">volume</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060">TerraformResource_060</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.cluster_network" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060.cluster_network">cluster_network</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.network" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060.network">network</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.storage_class" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060.storage_class">storage_class</a></code></li>
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_060.vlanconfig" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_060.vlanconfig">vlanconfig</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_063" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_063">TerraformResource_063</a></code></h4>
<ul class="">
<li><code><a title="harvester_e2e_tests.fixtures.terraform.TerraformResource_063.cloudinit_secret" href="#harvester_e2e_tests.fixtures.terraform.TerraformResource_063.cloudinit_secret">cloudinit_secret</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>